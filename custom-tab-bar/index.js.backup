Component({
  data: {
    selected: 0,
    list: [
      {
        pagePath: "pages/index/index",
        iconPath: "/images/icon64-gray.png",
        selectedIconPath: "/images/icon64.png",
        text: "多多仓"
      },
      {
        pagePath: "pages/longqiao/longqiao",
        iconPath: "/images/icon64-gray.png",
        selectedIconPath: "/images/icon64.png",
        text: "隆桥仓"
      },
      {
        pagePath: "pages/detail/detail",
        iconPath: "/images/icon64-gray.png",
        selectedIconPath: "/images/icon64.png",
        text: "关于"
      }
    ]
  },

  methods: {

    switchTab(e) {
      const index = e.currentTarget.dataset.index
      const item = this.data.list[index]
      
      // 如果已经是当前选中的tab，不执行跳转
      if (this.data.selected === index) {
        return
      }
      
      // 更新选中状态
      this.setData({
        selected: index
      })
      
      // 跳转到对应的tab页
      // 确保url以斜杠开头
      let url = item.pagePath
      if (!url.startsWith('/')) {
        url = '/' + url
      }
      wx.switchTab({
        url: url,
        fail: (err) => {
          console.error('切换tab失败:', err)
          // 跳转失败，恢复选中状态
          this.setData({
            selected: this.data.selected
          })
        }
      })
    },
    
    // 外部页面可以调用的方法，用于设置选中状态
    setSelected(index) {
      if (index >= 0 && index < this.data.list.length) {
        this.setData({
          selected: index
        })
      }
    }
  }
})